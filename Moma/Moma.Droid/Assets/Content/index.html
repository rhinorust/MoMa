<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="leaflet.css" />
    <script src="leaflet.js"></script>
    <script src="markers.js"></script>
    <script>
        function init() {
            //--TO DO
            //GET & PARSE JSON (add to separate js file before the marker.js file)
            //rearange the js and divide into separate files
            //adapt code to deal between storyline and free map (POI icons, paths, back to storyline selection page button)

            //--marker.js file contains coordinates that were parsed from json and the storyline trajectories

            //--set variable storylineSelected to the storyline id/number selected from the storyline selection page
            var storylineSelected = 1;

            //floor maps
            floor1Array.push(L.tileLayer('floor1/{z}/{x}/{y}.png', { minZoom: mapMinZoom, maxZoom: mapMaxZoom, bounds: mapBounds, attribution: '', noWrap: true, tms: false }));
            floor2Array.push(L.tileLayer('floor2/{z}/{x}/{y}.png', { minZoom: mapMinZoom, maxZoom: mapMaxZoom, bounds: mapBounds, attribution: '', noWrap: true, tms: false }));
            floor3Array.push(L.tileLayer('floor3/{z}/{x}/{y}.png', { minZoom: mapMinZoom, maxZoom: mapMaxZoom, bounds: mapBounds, attribution: '', noWrap: true, tms: false }));
            floor4Array.push(L.tileLayer('floor4/{z}/{x}/{y}.png', { minZoom: mapMinZoom, maxZoom: mapMaxZoom, bounds: mapBounds, attribution: '', noWrap: true, tms: false }));
            floor5Array.push(L.tileLayer('floor5/{z}/{x}/{y}.png', { minZoom: mapMinZoom, maxZoom: mapMaxZoom, bounds: mapBounds, attribution: '', noWrap: true, tms: false }));

            //storyline polyline paths
            if (storylineSelected == 1) {
                floor2Array.push(L.polyline(floor2latlngs, { color: '#0066ff' }));
            } else if (storylineSelected == 2) {

            } else if (storylineSelected == 3) {

            } else {
                //no storyline selected (free map)
            }

            //Floor layer groups
            var floor1LayerGroup = L.layerGroup(floor1Array),
                floor2LayerGroup = L.layerGroup(floor2Array),
                floor3LayerGroup = L.layerGroup(floor3Array),
                floor4LayerGroup = L.layerGroup(floor4Array),
                floor5LayerGroup = L.layerGroup(floor5Array);
               
            //floor radio buttons
            var baseMaps = {
                "1": floor1LayerGroup,
                "2": floor2LayerGroup,
                "3": floor3LayerGroup,
                "4": floor4LayerGroup,
                "5": floor5LayerGroup
            };
            //floor overlay radio buttons
            var overlayMaps = {
                //"Markers": floor1Overlay
            };

            //zoom levels
            var mapMinZoom = 1;
            var mapMaxZoom = 5;

            //create map
            var map = L.map('map', {
                maxZoom: mapMaxZoom,
                minZoom: mapMinZoom,
                crs: L.CRS.Simple,
                layers: floor1LayerGroup
            }).setView([0, 0], mapMaxZoom);
            //map bounds
            var mapBounds = new L.LatLngBounds(
              map.unproject([0, 3072], mapMaxZoom),
              map.unproject([6144, 0], mapMaxZoom));
            //add bounds to map
            map.fitBounds(mapBounds);
            //Add controls (radio buttons) to map in order to switch between floors
            L.control.layers(baseMaps, overlayMaps, { collapsed: false }).addTo(map).setPosition('bottomright');

            //L.rectangle(mapBounds, { color: "#ff7800", weight: 1 }).addTo(map);

            //STORYLINE======================================================
            //line between markers
            
            // zoom the map to the polyline
            //map.fitBounds(polyline.getBounds());
            
        }
    </script>
    <style>
        html, body, #map {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body onload="init()">
    <div id="map"></div>
</body>
</html>